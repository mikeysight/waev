{%csrf_token%}
<body>
<div id="app">
    <div class="container">
        <div class="large-12 medium-12 small-12 cell">
            <label>File 
                <input type="file" id="file" ref="file" v-on:change="handleFileUpload()"/>
            </label>
                <button @click="submitFile()">Submit</button>
        </div>
    </div>
</div>
<script src="https://unpkg.com/vue"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/axios/0.19.2/axios.min.js"></script>
<script>
    let app = new Vue({
        el: '#app',
        delimiters: ['[[', ']]'],
        data: {
            csrf_token: "",
            user: "",
            file: "",
            filename: "c_and_p_01.mp3",
            transcripts: [],
            token: ""
        },

        methods: {
            handleFileUpload(){
                this.file = this.$refs.file.files[0]
            },
            submitFile(){
                let formData= new FormData()
                formData.append(
                    'audio', this.file)
                formData.append('user', 1)
                formData.append('filename', this.filename)
                console.log(formData)
                axios.post('/api/v1/',
                    formData,
                    {
                        headers:{
                            'Content-Type':'multipart/form-data',
                            'X-CSRFToken': this.csrf_token
                        }
                    }).then(function(){
                        console.log('SUCCESS!!')
                    }).catch(function(){
                        console.log('FAILURE!!')
                    })
                let formData2= new FormData()
                formData2.append(
                    "filename", this.filename)
                axios({
                    method: 'post',
                    url:'http://localhost:8000/upload/',
                    data: formData2,               
                    headers:{
                        'X-CSRFToken': this.csrf_token
                    },

                }).then(response => console.log(response))
            }
        },
        mounted: function(){
            this.csrf_token=document.querySelector("input[name=csrfmiddlewaretoken]").value

        }
    })
</script>


